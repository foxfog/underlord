<!-- src/renderer/views/Settings.vue -->

<template>
	<div class="page-area __dark">
		<div class="content-area">
			<div class="settings-panel">
				<div class="ui-tabs">
					<div class="ui-tabs-header">
						<button 
							class="ui-tabs-label" 
							:class="{ '__active': activeSection === 'audio' }" 
							@click="activeSection = 'audio'"
						>
							Audio
						</button>
						<button 
							class="ui-tabs-label" 
							:class="{ '__active': activeSection === 'general' }" 
							@click="activeSection = 'general'"
						>
							General
						</button>
						<button 
							class="ui-tabs-label" 
							:class="{ '__active': activeSection === 'video' }" 
							@click="activeSection = 'video'"
						>
							Video
						</button>
					</div>
					<div class="ui-tabs-content">
						<div class="ui-tab" :class="{ '__active': activeSection === 'audio' }">
							<SettingsAudio />
						</div>
						<div class="ui-tab" :class="{ '__active': activeSection === 'general' }">
							<SettingsGeneral />
						</div>
						<div class="ui-tab" :class="{ '__active': activeSection === 'video' }">
							<SettingsVideo />
						</div>
					</div>
				</div>
				<div class="buttons">
					<button @click="saveSettings">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
					<button @click="resetToDefault">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
				</div>
			</div>
		</div>
		<div class="menu-area __static">
			<MainMenu />
		</div>
	</div>
</template>

<script setup>
	import { ref } from 'vue'
	import MainMenu from '@/components/MainMenu.vue'
	import SettingsAudio from '@/components/settings/SettingsAudio.vue'
	import SettingsGeneral from '@/components/settings/SettingsGeneral.vue'
	import SettingsVideo from '@/components/settings/SettingsVideo.vue'
	import { useSettingsStore } from '@/stores/settings'

	const store = useSettingsStore()
	const activeSection = ref('audio')

	async function saveSettings() {
		const current = await window.electronAPI.getSettings()
		const updated = {
			...current,
			audio: { ...store.audio },
			general: { ...store.general },
			video: { ...store.video }
		}
		window.electronAPI.saveSettings(JSON.parse(JSON.stringify(updated)))
	}

	async function resetToDefault() {
		const def = await window.electronAPI.getSettings('default')
		store.audio = { ...def.audio }
		store.general = { ...def.general }
		store.video = { ...def.video }
		await saveSettings()
	}
</script>